---
import Container from "@components/Container.astro";
import PageLayout from "@layouts/PageLayout.astro";
import ProjectCard from "@components/ProjectCard.astro";
import { PROJECTS } from "@consts";

import projectsData from "./projects.json";

const categories = [
    { name: "Blockchain Engineering", id: "blockchain" },
    { name: "AI & Intelligent Systems", id: "ai" },
    { name: "Full-Stack & Software Architecture", id: "software" },
    { name: "Developer Tools & Utilities", id: "tools" },
    { name: "Mini Apps", id: "creative" },
];

const getProjectLinks = (project: any) => {
    const links = [];
    if (project.liveUrl) {
        links.push({ label: "Live Demo", href: project.liveUrl });
    }
    if (project.url) {
        links.push({ label: "GitHub", href: project.url });
    }
    return links;
};
---

<PageLayout title={PROJECTS.TITLE} description={PROJECTS.DESCRIPTION}>
    <section class="pt-28 pb-12">
        <Container size="xl">
            <div class="animate space-y-4 text-center">
                <div class="text-xl md:text-2xl lg:text-3xl page-heading glass-panel">{PROJECTS.TITLE}</div>
                <article class="prose dark:prose-invert max-w-3xl mx-auto glass-panel">
                    <p>
                        I like to learn by building. These projects represent my work in blockchain, AI/ML, full-stack
                        applications, and developer productivity. Explore {projectsData.portfolio.totalProjects}+
                        projects across {projectsData.portfolio.categories.length} categories.
                    </p>
                </article>
            </div>
        </Container>
    </section>

    {
        categories.map((category) => {
            const projects =
                projectsData.portfolio.projects[category.name as keyof typeof projectsData.portfolio.projects] || [];
            if (projects.length === 0) return null;

            return (
                <section class="pb-16" id={category.id}>
                    <Container size="xl">
                        <div class="animate space-y-6">
                            <div>
                                <h2 class="text-2xl font-bold text-black dark:text-white glass-panel">
                                    {category.name}
                                </h2>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                {projects.map((project) => (
                                    <ProjectCard
                                        id={project.repo.split("/")[1]}
                                        title={project.title}
                                        stack={project.tags.slice(0, 3).join(" Â· ")}
                                        description={project.description}
                                        links={getProjectLinks(project)}
                                    />
                                ))}
                            </div>
                        </div>
                    </Container>
                </section>
            );
        })
    }
</PageLayout>
